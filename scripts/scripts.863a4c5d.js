"use strict";angular.module("movieApp",["ngAnimate","ngCookies","ngRoute","ngSanitize","ngTouch","slick","ngFlag"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/movie/:id",{templateUrl:"views/movie.html",controller:"MovieCtrl"}).when("/rechercher/:query",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/favoris",{templateUrl:"views/favoris.html",controller:"FavorisCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("movieApp").controller("MainCtrl",["$scope","MoviesDB","$http","$rootScope","$routeParams",function(a,b,c,d,e){b.loadMovies(),d.bgImage="";var f=null,f=e.query;a.MoviesDB=b,d.refresh=function(){b.loadMovies(),a.MoviesDB=b,d.query=""};var g=a.MoviesDB.getResearchedMovies();a.aMovie=g[0],null!=f&&(b.searchMovies(f),a.MoviesDB=b),a.addFavori=function(a){b.addFavori(a)}}]),angular.module("movieApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("movieApp").controller("MovieCtrl",["$scope","$routeParams","MoviesDB","$http","$rootScope",function(a,b,c,d,e){e.query="",e.MoviesDB=c,d.get("http://amc.ig.he-arc.ch:3003/movie/"+b.id+"?append_to_response=similar,releases,credits&language=fr").success(function(b){a.movie=b,e.bgImage=b.backdrop_path,a.countryFlags=[];for(var c=a.movie.releases.countries,d=0;d<c.length;d++)("DE"==c[d].iso_3166_1||"FR"==c[d].iso_3166_1||"US"==c[d].iso_3166_1)&&a.countryFlags.push(c[d]);a.actors=[];for(var f=a.movie.credits.cast,d=0;6>d;d++)a.actors.push(f[d]);a.realisator;for(var g=a.movie.credits.crew,d=0;d<g.length;d++)"Director"==g[d].job&&(a.realisator=g[d])})}]),angular.module("movieApp").factory("MoviesDB",["$http",function(a){function b(){localStorage.setItem("movies",JSON.stringify(d))}var c=[],d=[],e=localStorage.getItem("movies");if(e)var d=JSON.parse(e);else d=[];var f=42;return{imgURL:"http://image.tmdb.org/t/p/",someMethod:function(){return f},getResearchedMovies:function(){return c},searchMovies:function(b){a.get("http://amc.ig.he-arc.ch:3003/search/movie?query="+b+"&language=fr").success(function(a){c=a.results})},loadMovies:function(){a.get("http://amc.ig.he-arc.ch:3003/movie/upcoming?language=fr").success(function(a){c=a.results})},addFavori:function(a){d.push(a),b()},getFavoris:function(){return d},deleteFavori:function(a){d.splice(d.indexOf(a),1),b()},isId:function(a){for(var b=0;b<d.length;b++)return d.indexOf(a)>-1?!0:!1}}}]),angular.module("movieApp").filter("urlPoster",["MoviesDB",function(a){return function(b){return b?a.imgURL+"w185"+b:"/images/noposter.jpg"}}]),angular.module("movieApp").controller("FavorisCtrl",["$scope","MoviesDB","$http","$rootScope",function(a,b,c,d){c.get("http://amc.ig.he-arc.ch:3003/movie/upcoming?language=fr").success(function(c){a.movies=c.results,d.bgImage="",a.favorisId=b.getFavoris(),a.favoris=[];for(var e=a.movies,f=0;f<e.length;f++)a.favorisId.indexOf(e[f].id)>-1&&a.favoris.push(e[f]);a.deleteFavori=function(c){b.deleteFavori(c.id),a.favoris.splice(a.favoris.indexOf(c),1)},a.isId=function(a){b.isId(a)}})}]);